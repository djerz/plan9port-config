# ~/.acme/guide - master guide file with examples

## Notes

- Nomenclature:
  - BOLD are args that should be replaced with the appropriate string
  - [SQUAREBRACKETED] args are optional
  - ... indicate multiple args can be provided
- Wrap the commands in parentheses to make them selectable by
  double-clicking just to the right of the left parenthesis, e.g.
  (Edit =)

---

## Sam commands

- Sam commands can be run in Acme by using the Edit command
- See the Sam manpage for more information or Sam cheatsheet for idioms
  https://9fans.github.io/plan9port/man/man1/sam.html
  http://sam.cat-v.org/cheatsheet/

Edit =                  (current line number)
Edit ,|grep -n '.*'     (add line numbers)
Edit ,s/^[0-9]+://g     (remove line numbers)
Edit ,|sort -r          (reverse sort all lines in file)
Edit ,|wc -c            (count num characters in file)
Edit 0 < date           (insert date at start of file)
Edit -/{/,+/}/          (select contents of current { ... } block, including the enclosing braces)
Edit s/"([ˆ"]*)"/‘‘1’’/ (replace straight-quoted "word" with open-close quoted ‘‘word’’)
Edit x/ˆ/ .,/0d         (remove C comments from selection)
Edit ,x/^PREFIX/ .,/$/ s/REGEXP/REPLACEMENT/g
                        (apply REGEXP REPLACEMENT to each line that starts with PREFIX)
Edit ,x/REGIONREGEXP/ s/REGEXP/REPLACEMENT/g
                        (apply REGEXP REPLACEMENT to each region matching REGIONREGEXP)
Edit X/BUFREGEXP/ ,s/REGEXP/REPLACEMENT/g
                        (apply REGEXP REPLACEMENT across the entirety of buffers matching BUFREGEXP,
                        e.g. Edit X/.*/ ,s/xx/yy/g changes all xx occurrences to yy in all buffers)

---

## Text manipulation

- Commands require custom scripts in ~/.acme/bin

|c+ [COMMENTCHAR]       (comment selection, COMMENTCHAR is # if not specified)
|c- [COMMENTCHAR]       (uncomment selection, COMMENTCHAR is # if not specified)
|i+ [INDENTSTRING]      (indent selection, INDENTSTRING is a single tab char if not specified)
|i- [INDENTSTRING]      (unindent selection, INDENTSTRING is a single tab char if not specified)
|w+ [WIDTH]             (wrap selection, WIDTH is 70 if not specified)
|w-                     (unwrap selection / join lines)
|upper                  (uppercase selection)
|lower                  (lowercase selection)
|surround [BRACKETCHAR] (surround selection, BRACKETCHAR is left paren if not specified)
Edit ,|dtw              (delete trailing whitespace, i.e. spaces and tabs)

---

## Search and navigation

- Commands starting with : are run with Button3 (right-click, plumb)
  instead of the regular Button2 (middle-click, execute)
- When right-clicking on symbols that don't match a plumbing rule,
  a forward search is done in that buffer using that symbol
- rg+ requires custom script in ~/.acme/bin

:+/REGEXP               (REGEXP search forward, right-click to run, + optional)
:-/REGEXP               (REGEXP search backward, right-click to run)
rg+ REGEXP              (find lines in current dirtree files matching REGEXP using ripgrep)
rg --files|rg REGEXP    (find files with filename matching REGEXP using ripgrep)

:1                      (Select first line of buffer)
:$                      (Select last line of buffer)
:,                      (Select all lines in buffer)
:1,8                    (Select lines 1--8 in buffer)

---

## Unicode

- Requires the uni tool be installed on the system
  https://github.com/arp242/uni
- The easiest way to enter unicode characters is to search by
  description, and copy-paste the desired character

>uni i `{cat}           (identify chars in a string)
uni s DESCRIPTION       (search for unicode chars matching DESCRIPTION)
uni p CODEPOINT         (print unicode char(s) at CODEPOINT, which can be a code like U+2042 , a
                         range like 2042..2044 , a category like Po or a block like 'box drawing')
uni e DESCRIPTION       (print emoji matching DESCRIPTION)

---

## Slideshow

- Slideshows are directories with a index file ./index and multiple text files
  whose filenames without leading directories appear in the index file
- There should be no empty lines in the index file and the order of the
  filenames indicate the order of the slides
- Commands require custom scripts in ~/.acme/bin

Slide                   (start or restart slideshow in current directory)
Slide+                  (next slide)
Slide-                  (previous slide)

---

## Git

git commit -am 'COMMIT MESSAGE'
                        (commit with the given COMMIT MESSAGE)
git push -u origin      (push current local branch to origin)
git fetch               (fetch changes)
git merge origin/master (merge changes from origin/master branch)
git pull                (same as 'git fetch' followed by 'git merge FETCH_HEAD')
git rebase -i HEAD~3    (rebase interactively starting from 3 commits ago)
git checkout BRANCH     (switch to BRANCH)
git checkout -b NEWBRANCH
                        (create a new branch called NEWBRANCH and switch to it)

---

## acme-lsp

- Requires acme-lsp be installed and started
- Use the -v command-line option for verbose output
- https://pkg.go.dev/github.com/fhs/acme-lsp/cmd/L

L comp [-e]             (completion candidates, add -e to automatically apply if only one)
L def [-p]              (find definition and plumb, add -p to print only)
L fmt                   (format buffer and organize imports)
L hov                   (show hover info for symbol at cursor)
L impls                 (list implementation locations)
L refs                  (list references to symbol at cursor)
L rn NEWNAME            (rename symbol at cursor to NEWNAME)
L sig                   (show signature for function at cursor)
L syms                  (list symbols in the current file)
L type                  (find symbol type and plumb, add -p to print only)
L ws                    (list current workspace dirs)
L ws+ [DIR1] ...        (add workspace dirs, use current if none specified)
L ws- [DIR1] ...        (remove workspace dirs, use current if none specified)
L -showconfig           (show config values)

---

## Python

- runfc and condarun are custom scripts in ~/.acme/bin

Edit ,|runfc black      (format file using black)
condaenv=ENVNAME condarun pylint --output=parseable $%
                        (lint file using pylint in conda environment ENVNAME)
condaenv=ENVNAME condarun python3 -m pdb $%
                        (run current file in conda env ENVNAME under control of the pdb debugger)

---

## Markdown

- Compilation commands require pandoc (for PDF output, also requires a LaTeX distribution like TeXLive)
- Linting commands require markdownlint-cli installed via NVM in a POSIX-compatible shell like Bash

pandoc -o /tmp/markdown-preview.html $% && { xdg-open /tmp/markdown-preview.html || open /tmp/markdown-preview.html }
                         (compile current markdown file to html and preview it in reader, Linux or macOS)
bash -c '. $home/.nvm/nvm.sh && markdownlint '^$%^' && echo "No warnings or errors"'
                         (lint current markdown file)
