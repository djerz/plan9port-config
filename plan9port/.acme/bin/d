#!/usr/bin/env rc

# Diff current Acme window text against saved version
# Requires GNU diff

diffcmd=diff
if (gdiff --version >[2]/dev/null >[1=2]) {
	diffcmd=gdiff
}

echo "--------"

9p read acme/$winid/body | \
	$diffcmd --unchanged-line-format='' --old-line-format=$%^':%dn:-%L' --new-line-format=$%^':%dn:+%L' $samfile -- - | \
	9 sed -e 's/	/Â»~~~/g'

echo "--------"
